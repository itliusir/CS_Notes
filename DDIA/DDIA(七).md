# 从不可靠的组件构建可靠的系统

## 1. 不可靠的网络

我们都知道网络是不可靠的，例如网络出现分区，系统会不会出现多主节点。例如节点心跳超时，状态是否立即更改。

## 2. 不可靠的时钟

网络上的每台机器都有自己的时钟，这是一个实际的硬件设备：通常是石英晶体振荡器。这些设备不是完全准确的，所以每台机器都有自己的时间概念，可能比其他机器稍快或更慢。可以在一定程度上同步时钟：最常用的机制是**网络时间协议（NTP）**，它允许根据一组服务器报告的时间来调整计算机时钟。服务器则从更精确的时间源（如GPS接收机）获取时间。

## 3. 拜占庭故障

如果存在节点可能“撒谎”（发送任意错误或损坏的响应）的风险，则分布式系统的问题变得更困难了——例如，如果节点可能声称其实际上没有收到特定的消息。这种行为被称为**拜占庭故障（Byzantine fault）**，**在不信任的环境中达成共识的问题被称为拜占庭将军问题**。

## 4. 构建可靠的系统

分布式系统最重要的抽象之一就是**共识（consensus）**：**就是让所有的节点对某件事达成一致**。

### 线性一致性

线性一致性的视图是让系统看起来好像只有一个数据副本，要比最终一致性更加强。

最简单的线性一致性模型就是单主复制，而采用共识算法的系统也具有线性一致性(zk\etcd)